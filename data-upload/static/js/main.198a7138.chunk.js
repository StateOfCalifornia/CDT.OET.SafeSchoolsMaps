(this["webpackJsonpdata-upload"]=this["webpackJsonpdata-upload"]||[]).push([[0],{152:function(e,t){},173:function(e){e.exports=JSON.parse('{"featureServiceURL":"https://services3.arcgis.com/uknczv4rpevve42E/ArcGIS/rest/services/TrailerBillDistricts/FeatureServer/0","featureServiceURL_stage":"https://services3.arcgis.com/uknczv4rpevve42E/arcgis/rest/services/Trailer_Bill_Districts_Upload_STG/FeatureServer/0","templateUrl":"https://california.maps.arcgis.com/sharing/rest/content/items/2d458e6ee04b494a9747271ad8ffcc08/data","isValidField":"IsValid","isValidValue":"Valid","schoolNameFieldEsri":"school_name","schoolNameFieldExcel":"School","authInfo":{"clientId":"KZryzIWRkPmHUGlJ","portalUrl":"https://california-hub.maps.arcgis.com/sharing","popup":false}}')},239:function(e,t){},240:function(e,t){},257:function(e,t,n){},258:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),r=n(22),i=n.n(r),o=n(20),l=n.n(o),s=n(30),u=n(25),d=n(79),f=n(62),h=n.n(f),j=n(263),p=n(262),b=n(261),x=(n(6),function(){var e=Object(s.a)(l.a.mark((function e(t){var n,c,a,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.rows,c=t.fields,a=t.userSession,r=t.featureLayerUrl,e.next=3,Object(b.a)({authentication:a,url:r,features:n.map((function(e){var t={};return c.forEach((function(n){t[n.name]=e[n.alias]})),{attributes:t}}))});case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var g,O,m,v,w,y,S,k,C,B,_,L,E,D,U,F,R,T,A,P,I,z,N,M,V=n(28),H=n.n(V),G=n(166),J=n.n(G),Y=n(26),W=n.n(Y),q=n(13),K=n(9),Z=K.default.div(g||(g=Object(q.a)(["\n  height: 60px;\n  padding: 10px 0px;\n  background: ",";\n  box-sizing: border-box;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n"])),(function(e){return e.theme.palette.Brand_Blue_200})),Q=K.default.div(O||(O=Object(q.a)(["\n  display: flex;\n  align-items: center;\n  margin-right: 25px;\n  & img {\n    height: 70px;\n    margin-right: 15px;\n    background: #ffffff;\n    padding-left: 15px;\n  }\n  & h1 {\n    margin: 0;\n    font-size: 1.5em;\n    font-weight: 300;\n    color: ",";\n  }\n"])),(function(e){return e.theme.palette.white})),X=K.default.img(m||(m=Object(q.a)(["\n  background: "," !important;\n  height: 50px !important;\n"])),(function(e){return e.theme.palette.Brand_Blue_200})),$=Object(K.default)(h.a)(v||(v=Object(q.a)(["\n  color: ",";\n  height: auto !important;\n  background-color: ",";\n"])),(function(e){return e.theme.palette.white}),(function(e){return e.theme.palette.lightBlue})),ee=n(5),te=function(e){var t=e.account,n=t.user,c=t.portal,a=e.attemptLogout;return Object(ee.jsxs)(Z,{children:[Object(ee.jsxs)(Q,{children:[Object(ee.jsx)(X,{src:"https://california.maps.arcgis.com/sharing/rest/content/items/eabecb26ec754b849c44175495e31e66/data",alt:"Header Logo"}),Object(ee.jsx)("h1",{children:"CA Safe Schools - Data Import"})]}),Object(ee.jsx)($,{user:n,portal:c,hideSwitchAccount:!0,onRequestSignOut:a})]})},ne=n(167),ce=n.n(ne),ae=a.a.createContext({loading:void 0,setLoading:void 0,error:void 0,setError:void 0,data:void 0,setData:void 0,config:void 0}),re=n(78),ie=n.n(re),oe=n(65),le=K.default.div(w||(w=Object(q.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n"]))),se=(K.default.div(y||(y=Object(q.a)(["\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding-left: 10px;\n  background-color: ",";\n"])),(function(e){return e.index%2?e.theme.palette.Brand_Blue_100:""})),K.default.div(S||(S=Object(q.a)(["\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  background-color: ",";\n  color: #ffffff;\n"])),(function(e){return e.theme.palette.Brand_Blue_200})),Object(K.default)(oe.a)(k||(k=Object(q.a)(["\n  border: 1px solid ",";\n"])),(function(e){return e.theme.palette.Brand_Blue_200})),n(19)),ue=n(73),de=function(){var e=Object(c.useContext)(ae),t=e.setLoading,n=e.data,a=e.setData,r=e.setError,i=e.config,o=Object(c.useState)([]),d=Object(u.a)(o,2),f=d[0],h=d[1];Object(c.useEffect)((function(){a(f.filter((function(e){return e[i.isValidField]===i.isValidValue})))}),[i,f,a]);var j=function(){var e=Object(s.a)(l.a.mark((function e(n){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r(null),a([]),t(!0),(c=new Promise((function(e,t){try{var c=new FileReader;n.target.files&&n.target.files.length||e(null),c.readAsArrayBuffer(n.target.files[0]),c.onload=function(t){var n=t.target.result,c=ie.a.read(n,{type:"buffer",cellDates:!0,dateNF:"YYYY-MM-DD"}),a=c.SheetNames[0],r=c.Sheets[a],o=ie.a.utils.sheet_to_json(r).filter((function(e){return e[i.schoolNameFieldExcel]}));e(o)},c.onerror=function(e){t(e)}}catch(a){t(a)}}))).then((function(e){t(!1),e&&h(e)})),c.catch((function(e){console.error(e),r("Error Processing File")}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p="The uploaded file contains valid data for ".concat(n.length," of the ").concat(f.length," schools\n   in the district. Click Next to submit.");return Object(ee.jsxs)(le,{children:[Object(ee.jsx)(ue.CalciteH2,{children:"Upload & Review"}),Object(ee.jsx)(se.CalciteP,{children:"Upload your populated Excel document. Only valid rows will be submitted."}),Object(ee.jsx)(ce.a,{accept:".xlsx,.xls",onChange:j}),Object(ee.jsx)(se.CalciteP,{style:{paddingTop:"10px"},children:n.length?p:""})]})},fe=n(64),he=n.n(fe),je=K.default.div(C||(C=Object(q.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  width: 80%;\n  max-width: 800px;\n  margin: 8% auto;\n  border: 2px solid #1f2574;\n  box-shadow: 0px 0px 8px 2px rgb(10 10 10 / 25%);\n"]))),pe=K.default.div(B||(B=Object(q.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  height: 100%;\n  padding: 36px;\n"]))),be=K.default.div(_||(_=Object(q.a)(["\n  width: calc(100% - 4rem);\n  background: ",";\n  padding: 2rem;\n"])),(function(e){return e.theme.palette.lightestGray})),xe=Object(K.default)(fe.ModalActions)(L||(L=Object(q.a)(["\n  justify-content: space-between;\n"]))),ge=K.default.div(E||(E=Object(q.a)(["\n  display: flex;\n  flex-direction: column;\n\n  height: 100%;\n"]))),Oe=Object(K.default)(H.a)(D||(D=Object(q.a)(["\n  width: 200px;\n"]))),me=n(170),ve=n.n(me),we=function(e){var t=e.fileUrl;return Object(ee.jsxs)(ge,{children:[Object(ee.jsx)(se.CalciteH2,{children:"Download Template"}),Object(ee.jsx)(se.CalciteP,{children:"Download Excel template. Select your county and district, then populate school data."}),Object(ee.jsx)(Oe,{href:t,download:"CASchools_District_DataTemplate.xlsx",icon:Object(ee.jsx)(ve.a,{size:16}),children:"Download"})]})},ye=K.default.div(U||(U=Object(q.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  width: 100%;\n"]))),Se=n(171),ke=n.n(Se),Ce=n(172),Be=n.n(Ce),_e=K.default.div(F||(F=Object(q.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  width: 100%;\n"]))),Le=K.default.div(R||(R=Object(q.a)(["\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding-left: 10px;\n  background-color: ",";\n  color: ",";\n"])),(function(e){return e.index%2?e.theme.palette.lightBlue:""}),(function(e){return e.index%2?e.theme.palette.white:""})),Ee=(K.default.div(T||(T=Object(q.a)(["\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  background-color: ",";\n  color: #ffffff;\n"])),(function(e){return e.theme.palette.Brand_Blue_200})),Object(K.default)(oe.a)(A||(A=Object(q.a)(["\n  border: 1px solid ",";\n"])),(function(e){return e.theme.palette.Brand_Blue_200}))),De=function(e){var t=e.schools,n=e.schoolField;return Object(ee.jsx)(_e,{children:t.length?Object(ee.jsx)(Ee,{height:Math.min(200,40*t.length),overscanRowCount:10,rowCount:t.length,rowHeight:40,rowRenderer:function(e){var c=e.index,a=(e.isScrolling,e.key),r=e.style,i=t[c];return Object(ee.jsx)(Le,{style:r,index:c,children:i[n]},a)},width:600}):""})},Ue=function(e){var t=e.results,n=Object(c.useContext)(ae),a=n.config,r=n.data,i=t.addResults,o=[];i.forEach((function(e,t){e.success||o.push(r[t])}));var l=o.length?"There was an error submitting ".concat(o.length," of ").concat(i.length," schools. The below schools were not added."):null;return l?Object(ee.jsxs)(ye,{children:[Object(ee.jsx)(Be.a,{size:100,color:"red",style:{margin:"auto"}}),Object(ee.jsx)(se.CalciteH3,{children:"Error"}),Object(ee.jsx)(se.CalciteP,{children:l}),Object(ee.jsx)(De,{schools:o,schoolField:a.schoolNameFieldEsri})]}):Object(ee.jsxs)(ye,{style:{alignItems:"center"},children:[Object(ee.jsx)(ke.a,{size:100,color:"green",style:{margin:"auto"}}),Object(ee.jsx)(se.CalciteH3,{children:"Success! All ".concat(i.length," schools updated.")})]})},Fe=function(e){var t=e.account,n=e.appConfig,a=e.attemptLogout,r=Object(c.useState)(!1),i=Object(u.a)(r,2),o=i[0],d=i[1],f=Object(c.useState)(null),h=Object(u.a)(f,2),b=h[0],g=h[1],O=Object(c.useState)([]),m=Object(u.a)(O,2),v=m[0],w=m[1],y=Object(c.useState)([]),S=Object(u.a)(y,2),k=S[0],C=S[1],B=Object(c.useState)(1),_=Object(u.a)(B,2),L=_[0],E=_[1],D=Object(c.useState)(null),U=Object(u.a)(D,2),F=U[0],R=U[1],T=Object(c.useMemo)((function(){return new j.a(t)}),[t]);Object(c.useEffect)((function(){var e=function(){var e=Object(s.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(p.a)({authentication:T,url:n.featureServiceURL});case 3:(t=e.sent)&&t.fields&&C(t.fields.filter((function(e){return v[0].hasOwnProperty(e.alias)}))),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),g("Error Saving Data. (Fields)");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();v.length&&e()}),[v,T,n]);var A=function(){var e=Object(s.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.next=3,x({rows:v,fields:k,userSession:T,featureLayerUrl:n.featureServiceURL});case 3:t=e.sent,R(t),E(L+1),d(!1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(ee.jsx)(ae.Provider,{value:{loading:o,setLoading:d,error:b,setError:g,data:v,setData:w,config:n},children:Object(ee.jsxs)("div",{children:[Object(ee.jsx)(te,{account:t,attemptLogout:a}),Object(ee.jsxs)(je,{children:[Object(ee.jsx)(be,{children:Object(ee.jsxs)(W.a,{currentStep:L,children:[Object(ee.jsxs)(Y.Step,{children:[Object(ee.jsx)(Y.StepTitle,{children:"Download"}),Object(ee.jsx)(Y.StepDescription,{children:"Download the Excel template to report school data."})]}),Object(ee.jsxs)(Y.Step,{error:b&&2===L,children:[Object(ee.jsx)(Y.StepTitle,{children:"Upload"}),Object(ee.jsx)(Y.StepDescription,{children:b&&2===L?b:"Upload the excel template populated with your schools information."})]}),Object(ee.jsxs)(Y.Step,{children:[Object(ee.jsx)(Y.StepTitle,{children:"Summary"}),Object(ee.jsx)(Y.StepDescription,{children:"Summary of your submitted school data."})]})]})}),Object(ee.jsxs)(pe,{children:[o&&Object(ee.jsx)(J.a,{sizeRatio:2,style:{position:"absolute",top:"30%",left:"50%"}},"uploadLoader"),1===L&&Object(ee.jsx)(we,{fileUrl:n.templateUrl}),2===L&&Object(ee.jsx)(de,{}),3===L&&Object(ee.jsx)(Ue,{results:F})]}),Object(ee.jsx)(xe,{children:Object(ee.jsxs)("div",{children:[2===L?Object(ee.jsx)(H.a,{clear:!0,onClick:function(){E(L-1)},style:{marginRight:".5rem"},children:"Previous"}):"",Object(ee.jsx)(H.a,{disabled:2===L&&(!v||!v.length),onClick:function(){1===L?E(L+1):2===L?A():(w([]),E(1))},children:["Next","Submit","Restart"][L-1]})]})})]})]})})},Re=n.p+"static/media/splashBackground.5204fcdc.jpg",Te=K.default.div(P||(P=Object(q.a)(["\n  position: absolute;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  width: 100%;\n  background: url(",") center/cover\n    no-repeat;\n"])),(function(e){return e.error?"":Re})),Ae=Object(K.default)(he.a)(I||(I=Object(q.a)(["\n  width: 350px;\n"]))),Pe=K.default.div(z||(z=Object(q.a)(["\n  text-align: center;\n"]))),Ie=K.default.img(N||(N=Object(q.a)(["\n  width: 177px;\n"]))),ze=Object(K.default)(H.a)(M||(M=Object(q.a)(["\n  margin-top: 1rem;\n  background-color: #1b449d;\n"]))),Ne=function(e){var t=e.attemptLogin;return Object(ee.jsx)(Te,{children:Object(ee.jsx)(Ae,{open:!0,appElement:document.body,overlayStyle:{background:"unset"},children:Object(ee.jsxs)(Pe,{children:[Object(ee.jsx)(Ie,{src:"https://california.maps.arcgis.com/sharing/rest/content/items/eabecb26ec754b849c44175495e31e66/data",alt:"App Logo"}),Object(ee.jsx)(se.CalciteP,{children:"Login to upload school data."}),Object(ee.jsx)(ze,{fullWidth:!0,onClick:t,children:"Proceed to Login"})]})})})},Me=function(e){var t=e.config,n=Object(d.a)(Object(d.a)({},t.authInfo),{redirectUri:window.location.href}),a=Object(f.useAccountManager)(n),r=a.accountManagerState,i=a.addAccount,o=a.logoutAccount,h=r.active,b=r.accounts,x=Object(c.useState)(null),g=Object(u.a)(x,2),O=g[0],m=g[1];Object(c.useEffect)((function(){var e=function(){var e=Object(s.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(p.a)({authentication:new j.a(b[h]),url:t.featureServiceURL});case 3:(n=e.sent)&&n.fields&&m(!0),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),m(!1);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();h&&b[h]&&b[h].session&&e()}),[b,h,t.featureServiceURL]);var v=function(){i(n)};return h&&b[h]&&b[h].session&&null!==O?O?Object(ee.jsx)(Fe,{appConfig:t,account:b[h],userSession:new j.a(b[h].session),attemptLogout:function(){o(b[h])}}):(o(b[h]),Object(ee.jsx)(Ne,{attemptLogin:v})):Object(ee.jsx)(Ne,{attemptLogin:v})},Ve=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,264)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),c(e),a(e),r(e),i(e)}))},He=(n(257),n(18)),Ge=n.n(He),Je=n(173),Ye=He.CalciteTheme;Ye.palette.Brand_Blue_200="#1f2574",Ye.palette.blue="#1f2574",Ye.palette.lightBlue="#5258A7",Ye.palette.darkBlue="#5258A7",i.a.render(Object(ee.jsx)(a.a.StrictMode,{children:Object(ee.jsx)(Ge.a,{children:Object(ee.jsx)(Me,{config:Je})})}),document.getElementById("root")),Ve()}},[[258,1,2]]]);
//# sourceMappingURL=main.198a7138.chunk.js.map