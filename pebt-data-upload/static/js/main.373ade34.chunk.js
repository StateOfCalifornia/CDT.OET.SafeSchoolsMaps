(this["webpackJsonpdata-upload"]=this["webpackJsonpdata-upload"]||[]).push([[0],{156:function(e,t){},177:function(e){e.exports=JSON.parse('{"env":"prod","dev":{"featureServiceURL":"https://services3.arcgis.com/uknczv4rpevve42E/arcgis/rest/services/PEBT_District_Data_STAGING/FeatureServer/0","templateUrl":"https://california.maps.arcgis.com/sharing/rest/content/items/ffa9173d108542abae2c97ea6c8b240e/data"},"prod":{"featureServiceURL":"https://services3.arcgis.com/uknczv4rpevve42E/arcgis/rest/services/PEBT_District_Data_PROD/FeatureServer/0","templateUrl":"https://california.maps.arcgis.com/sharing/rest/content/items/4b01f4afa06341f996fb79dee89b97dc/data"},"dev-schools":{"featureServiceURL":"https://services3.arcgis.com/uknczv4rpevve42E/arcgis/rest/services/Trailer_Bill_Districts_Upload_STG/FeatureServer/0","templateUrl":"https://california.maps.arcgis.com/sharing/rest/content/items/bf81501c7f5a415499543f5c2ecd6790/data"},"prod-schools":{"featureServiceURL":"https://services3.arcgis.com/uknczv4rpevve42E/ArcGIS/rest/services/TrailerBillDistricts/FeatureServer/0","templateUrl":"https://california.maps.arcgis.com/sharing/rest/content/items/2d458e6ee04b494a9747271ad8ffcc08/data"},"hasVersioning":false,"isValidField":"IsValid","isValidValue":"Valid","schoolNameFieldEsri":"school_name","schoolNameFieldExcel":"School","dataSheetName":"Data Entry","version":{"sheet":"Version","major":"Major","minor":"Minor","date":"Last Updated","message":"Message"},"authInfo":{"clientId":"SQRvxdThUY3ZLikj","clientId-schools":"KZryzIWRkPmHUGlJ","portalUrl":"https://california-hub.maps.arcgis.com/sharing","popup":false}}')},240:function(e,t){},241:function(e,t){},265:function(e,t,n){},266:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(22),i=n.n(c),o=n(19),s=n.n(o),l=n(27),u=n(23),d=n(84),f=n(64),h=n.n(f),j=n(271),p=n(270),b=n(269),x=(n(6),function(){var e=Object(l.a)(s.a.mark((function e(t){var n,a,r,c,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.rows,a=t.fields,r=t.userSession,c=t.featureLayerUrl,e.next=3,Object(b.a)({authentication:r,url:c,features:n.map((function(e){var t={};return a.forEach((function(n){t[n.name]=e[n.alias]})),{attributes:t}}))});case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var g,O,v,m,w,S,y,k,_,E,B,D,C,L,U,P,T,F,I,R,V,A,M,z,N,Y,H=n(25),G=n.n(H),J=n(171),W=n.n(J),Z=n(28),q=n.n(Z),K=n(13),Q=n(8),X=Q.default.div(g||(g=Object(K.a)(["\n  height: 60px;\n  padding: 10px 0px;\n  background: ",";\n  box-sizing: border-box;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n"])),(function(e){return e.theme.palette.Brand_Blue_200})),$=Q.default.div(O||(O=Object(K.a)(["\n  display: flex;\n  align-items: center;\n  margin-right: 25px;\n  & img {\n    height: 70px;\n    margin-right: 15px;\n    background: #ffffff;\n    padding-left: 15px;\n  }\n  & h1 {\n    margin: 0;\n    font-size: 1.5em;\n    font-weight: 300;\n    color: ",";\n  }\n"])),(function(e){return e.theme.palette.white})),ee=Q.default.img(v||(v=Object(K.a)(["\n  background: "," !important;\n  height: 50px !important;\n"])),(function(e){return e.theme.palette.Brand_Blue_200})),te=Object(Q.default)(h.a)(m||(m=Object(K.a)(["\n  color: ",";\n  height: auto !important;\n  background-color: ",";\n"])),(function(e){return e.theme.palette.white}),(function(e){return e.theme.palette.lightBlue})),ne=n(5),ae=function(e){var t=e.account,n=t.user,a=t.portal,r=e.attemptLogout,c=e.isDev;return Object(ne.jsxs)(X,{children:[Object(ne.jsxs)($,{children:[Object(ne.jsx)(ee,{src:"https://california.maps.arcgis.com/sharing/rest/content/items/1a910074a4c0401191d8e88cea0d2d89/data",alt:"Header Logo"}),Object(ne.jsx)("h1",{children:"P-EBT Data Import".concat(c?" DEVELOPMENT":"")})]}),Object(ne.jsx)(te,{user:n,portal:a,hideSwitchAccount:!0,onRequestSignOut:r})]})},re=r.a.createContext({loading:void 0,setLoading:void 0,error:void 0,setError:void 0,data:void 0,setData:void 0,versionInfo:void 0,setVersionInfo:void 0,config:void 0}),ce=n(41),ie=n.n(ce),oe=n(68),se=n(53),le=n.n(se),ue=Q.default.div(w||(w=Object(K.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n"]))),de=Q.default.div(S||(S=Object(K.a)(["\n  margin-top: 15px;\n"]))),fe=Object(Q.default)(le.a)(y||(y=Object(K.a)(["\n  border: 1px solid ",";\n  max-width: unset;\n  box-shadow: unset;\n"])),(function(e){return e.theme.palette.Brand_Blue_200})),he=(Q.default.div(k||(k=Object(K.a)(["\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding-left: 10px;\n  background-color: ",";\n"])),(function(e){return e.index%2?e.theme.palette.Brand_Blue_100:""})),Q.default.div(_||(_=Object(K.a)(["\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  background-color: ",";\n  color: #ffffff;\n"])),(function(e){return e.theme.palette.Brand_Blue_200})),Object(Q.default)(oe.a)(E||(E=Object(K.a)(["\n  border: 1px solid ",";\n"])),(function(e){return e.theme.palette.Brand_Blue_200})),n(18)),je=n(77),pe=n(79),be=n.n(pe),xe=n(66),ge=n.n(xe),Oe=n(174),ve=n.n(Oe),me=Q.default.div(B||(B=Object(K.a)(["\n  display: flex;\n  flex-direction: column;\n\n  height: 100%;\n"]))),we=Object(Q.default)(G.a)(D||(D=Object(K.a)(["\n  width: 200px;\n"]))),Se=function(e){e.onVersionError;var t=Object(a.useContext)(re),n=t.setLoading,r=t.data,c=t.versionInfo,i=t.setData,o=t.setError,d=t.config,f=Object(a.useState)([]),h=Object(u.a)(f,2),j=h[0],p=h[1],b=Object(a.useState)(!1),x=Object(u.a)(b,2),g=x[0],O=x[1];Object(a.useEffect)((function(){i(j.filter((function(e){return e[d.isValidField]===d.isValidValue})))}),[d,j,i]);var v=function(){var e=Object(l.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o(null),i([]),n(!0),O(!1),(a=new Promise((function(e,n){try{var a=new FileReader;t.target.files&&t.target.files.length||e(null),a.readAsArrayBuffer(t.target.files[0]),a.onload=function(t){var n=t.target.result,a=ie.a.read(n,{type:"buffer",cellDates:!0,dateNF:"YYYY-MM-DD"});if(d.hasVersioning)try{var r=a.Sheets[d.version.sheet],i=ie.a.utils.sheet_to_json(r)[0],o=d.version.major;c[o]!==i[o]&&e({versionError:!0})}catch(f){e({versionError:!0})}var s=a.SheetNames[0],l=a.Sheets[s],u=ie.a.utils.sheet_to_json(l).filter((function(e){return e[d.schoolNameFieldExcel]}));e(u)},a.onerror=function(e){n(e)}}catch(r){n(r)}}))).then((function(e){n(!1),e?e.versionError?O(!0):p(e):o("Error Processing File")})),a.catch((function(e){console.error(e),o("Error Processing File")}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m="The uploaded file contains valid data for ".concat(r.length," of the ").concat(j.length," schools\n   in the district. Click Next to submit.");return Object(ne.jsxs)(ue,{children:[Object(ne.jsx)(je.CalciteH2,{children:"Upload & Review"}),Object(ne.jsx)(he.CalciteP,{children:"Upload your populated Excel document. Only valid rows will be submitted."}),Object(ne.jsx)(ve.a,{accept:".xlsx,.xls",onChange:v}),Object(ne.jsx)(he.CalciteP,{style:{paddingTop:"10px"},children:r.length?m:""}),g?Object(ne.jsxs)(fe,{icon:Object(ne.jsx)(be.a,{size:24}),children:[Object(ne.jsx)(se.AlertTitle,{children:"Invalid Excel File"}),Object(ne.jsx)(se.AlertMessage,{children:"The file uploaded does not match the current version of the template. Please download the latest, populate, and upload again."}),Object(ne.jsx)(de,{children:Object(ne.jsx)(we,{href:d[d.env].templateUrl,download:"CASchools_District_DataTemplate.xlsx",icon:Object(ne.jsx)(ge.a,{size:16}),children:"Download"})})]}):""]})},ye=n(67),ke=n.n(ye),_e=Q.default.div(C||(C=Object(K.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  width: 80%;\n  max-width: 800px;\n  margin: 8% auto;\n  border: 2px solid #0a3f35;\n  box-shadow: 0px 0px 8px 2px rgb(10 10 10 / 25%);\n"]))),Ee=Q.default.div(L||(L=Object(K.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  height: 100%;\n  padding: 36px;\n"]))),Be=Q.default.div(U||(U=Object(K.a)(["\n  width: calc(100% - 4rem);\n  background: ",";\n  padding: 2rem;\n"])),(function(e){return e.theme.palette.lightestGray})),De=Object(Q.default)(ye.ModalActions)(P||(P=Object(K.a)(["\n  justify-content: space-between;\n"]))),Ce=n(175),Le=n.n(Ce),Ue=function(e){var t=e.userSession,n=Object(a.useContext)(re),r=n.setVersionInfo,c=n.versionInfo,i=n.setLoading,o=n.setError,u=n.config;Object(a.useEffect)((function(){var e=function(){var e=Object(l.a)(s.a.mark((function e(){var n,a,c,l,d,f;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(u[u.env].templateUrl,"?token=").concat(t.token));case 3:return n=e.sent,e.next=6,n.arrayBuffer();case 6:a=e.sent,c=ie.a.read(a,{type:"buffer",cellDates:!0,dateNF:"YYYY-MM-DD"}),l=u.version.sheet,c.Sheets.hasOwnProperty(l)?(d=c.Sheets[l],f=ie.a.utils.sheet_to_json(d),r(f[0])):o("Sheet ".concat(l," not found in workbook")),i(!1),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),o("Unable to verify Template Version"),i(!1);case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}();u.hasVersioning&&!c&&(i(!0),e())}),[r,u,o,i,t,c]);return Object(ne.jsxs)(me,{children:[Object(ne.jsx)(he.CalciteH2,{children:"Download Template"}),Object(ne.jsx)(he.CalciteP,{children:"Download Excel template. Select your county and district, then populate school data."}),function(){if(!u.hasVersioning)return"";var e=c[u.version.message],t=c[u.version.date];return Object(ne.jsxs)(ne.Fragment,{children:[e?Object(ne.jsx)(he.CalciteP,{children:e}):"",t?Object(ne.jsx)(he.CalciteP,{children:"Last Updated: ".concat(Le()(c[u.version.date]).format("LL"))}):""]})}(),Object(ne.jsx)(we,{href:u[u.env].templateUrl,download:"CASchools_District_DataTemplate.xlsx",icon:Object(ne.jsx)(ge.a,{size:16}),children:"Download"})]})},Pe=Q.default.div(T||(T=Object(K.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  width: 100%;\n"]))),Te=n(78),Fe=n.n(Te),Ie=n(176),Re=n.n(Ie),Ve=Q.default.div(F||(F=Object(K.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  width: 100%;\n"]))),Ae=Q.default.div(I||(I=Object(K.a)(["\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding-left: 10px;\n  background-color: ",";\n  color: ",";\n"])),(function(e){return e.index%2?e.theme.palette.lightBlue:""}),(function(e){return e.index%2?e.theme.palette.white:""})),Me=(Q.default.div(R||(R=Object(K.a)(["\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  background-color: ",";\n  color: #ffffff;\n"])),(function(e){return e.theme.palette.Brand_Blue_200})),Object(Q.default)(oe.a)(V||(V=Object(K.a)(["\n  border: 1px solid ",";\n"])),(function(e){return e.theme.palette.Brand_Blue_200}))),ze=function(e){var t=e.schools,n=e.schoolField;return Object(ne.jsx)(Ve,{children:t.length?Object(ne.jsx)(Me,{height:Math.min(200,40*t.length),overscanRowCount:10,rowCount:t.length,rowHeight:40,rowRenderer:function(e){var a=e.index,r=(e.isScrolling,e.key),c=e.style,i=t[a];return Object(ne.jsx)(Ae,{style:c,index:a,children:i[n]},r)},width:600}):""})},Ne=function(e){var t=e.results,n=Object(a.useContext)(re),r=n.config,c=n.data,i=t.addResults,o=[];i.forEach((function(e,t){e.success||o.push(c[t])}));var s=o.length?"There was an error submitting ".concat(o.length," of ").concat(i.length," schools. The below schools were not added."):null;return s?Object(ne.jsxs)(Pe,{children:[Object(ne.jsx)(Re.a,{size:100,color:"red",style:{margin:"auto"}}),Object(ne.jsx)(he.CalciteH3,{children:"Error"}),Object(ne.jsx)(he.CalciteP,{children:s}),Object(ne.jsx)(ze,{schools:o,schoolField:r.schoolNameFieldEsri})]}):Object(ne.jsxs)(Pe,{style:{alignItems:"center"},children:[Object(ne.jsx)(Fe.a,{size:100,color:"green",style:{margin:"auto"}}),Object(ne.jsx)(he.CalciteH3,{children:"Success! All ".concat(i.length," schools updated.")}),Object(ne.jsxs)(he.CalciteP,{children:["Please navigate to the",Object(ne.jsx)(G.a,{inline:!0,href:"https://ca-reopening-status-survey-site-california.hub.arcgis.com/",target:"_blank",children:" school status submission site "})," ","to submit your school status in accordance with AB-86 if you have not done so already."]})]})},Ye=function(e){var t=e.account,n=e.appConfig,r=e.attemptLogout,c=Object(a.useState)(!1),i=Object(u.a)(c,2),o=i[0],d=i[1],f=Object(a.useState)(null),h=Object(u.a)(f,2),b=h[0],g=h[1],O=Object(a.useState)([]),v=Object(u.a)(O,2),m=v[0],w=v[1],S=Object(a.useState)(null),y=Object(u.a)(S,2),k=y[0],_=y[1],E=Object(a.useState)([]),B=Object(u.a)(E,2),D=B[0],C=B[1],L=Object(a.useState)(1),U=Object(u.a)(L,2),P=U[0],T=U[1],F=Object(a.useState)(null),I=Object(u.a)(F,2),R=I[0],V=I[1],A=Object(a.useMemo)((function(){return new j.a(t)}),[t]);Object(a.useEffect)((function(){var e=function(){var e=Object(l.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(p.a)({authentication:A,url:n[n.env].featureServiceURL});case 3:(t=e.sent)&&t.fields&&C(t.fields.filter((function(e){return m[0].hasOwnProperty(e.alias)}))),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),g("Error Saving Data. (Fields)");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();m.length&&e()}),[m,A,n]);var M=function(){var e=Object(l.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.next=3,x({rows:m,fields:D,userSession:A,featureLayerUrl:n[n.env].featureServiceURL});case 3:t=e.sent,V(t),T(P+1),d(!1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(ne.jsx)(re.Provider,{value:{loading:o,setLoading:d,error:b,setError:g,data:m,setData:w,versionInfo:k,setVersionInfo:_,config:n},children:Object(ne.jsxs)("div",{children:[Object(ne.jsx)(ae,{account:t,attemptLogout:r,isDev:"dev"===n.env}),Object(ne.jsxs)(_e,{children:[Object(ne.jsx)(Be,{children:Object(ne.jsxs)(q.a,{currentStep:P,children:[Object(ne.jsxs)(Z.Step,{error:b&&1===P,children:[Object(ne.jsx)(Z.StepTitle,{children:"Download"}),Object(ne.jsx)(Z.StepDescription,{children:b&&1===P?b:"Download the Excel template to report school data."})]}),Object(ne.jsxs)(Z.Step,{error:b&&2===P,children:[Object(ne.jsx)(Z.StepTitle,{children:"Upload"}),Object(ne.jsx)(Z.StepDescription,{children:b&&2===P?b:"Upload the excel template populated with your schools information."})]}),Object(ne.jsxs)(Z.Step,{children:[Object(ne.jsx)(Z.StepTitle,{children:"Summary"}),Object(ne.jsx)(Z.StepDescription,{children:"Summary of your submitted school data."})]})]})}),Object(ne.jsxs)(Ee,{children:[o&&Object(ne.jsx)(W.a,{sizeRatio:2,style:{position:"absolute",top:"30%",left:"50%"}},"uploadLoader"),1===P&&Object(ne.jsx)(Ue,{versionInfo:n.version,userSession:A}),2===P&&Object(ne.jsx)(Se,{}),3===P&&Object(ne.jsx)(Ne,{results:R})]}),Object(ne.jsx)(De,{children:Object(ne.jsxs)("div",{children:[2===P?Object(ne.jsx)(G.a,{clear:!0,onClick:function(){T(P-1),g(null)},style:{marginRight:".5rem"},children:"Previous"}):"",Object(ne.jsx)(G.a,{disabled:2===P&&(!m||!m.length)||Boolean(b),onClick:function(){1===P?T(P+1):2===P?M():(w([]),T(1))},children:["Next","Submit","Restart"][P-1]})]})})]})]})})},He=n.p+"static/media/splashBackground.e4c50044.jpg",Ge=Q.default.div(A||(A=Object(K.a)(["\n  position: absolute;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  width: 100%;\n  background: url(",") center/cover\n    no-repeat;\n"])),(function(e){return e.error?"":He})),Je=Object(Q.default)(ke.a)(M||(M=Object(K.a)(["\n  width: 350px;\n"]))),We=Q.default.div(z||(z=Object(K.a)(["\n  text-align: center;\n"]))),Ze=Q.default.img(N||(N=Object(K.a)(["\n  width: 177px;\n"]))),qe=Object(Q.default)(G.a)(Y||(Y=Object(K.a)(["\n  margin-top: 1rem;\n  background-color: #0a3f35;\n"]))),Ke=function(e){var t=e.attemptLogin;return Object(ne.jsx)(Ge,{children:Object(ne.jsx)(Je,{open:!0,appElement:document.body,overlayStyle:{background:"unset"},children:Object(ne.jsxs)(We,{children:[Object(ne.jsx)(Ze,{src:"https://california.maps.arcgis.com/sharing/rest/content/items/1a910074a4c0401191d8e88cea0d2d89/data",alt:"App Logo"}),Object(ne.jsx)(he.CalciteP,{children:"Login to upload data."}),Object(ne.jsx)(qe,{fullWidth:!0,onClick:t,children:"Proceed to Login"})]})})})},Qe=function(e){var t=e.config,n=Object(d.a)(Object(d.a)({},t.authInfo),{redirectUri:window.location.href}),r=Object(f.useAccountManager)(n),c=r.accountManagerState,i=r.addAccount,o=r.logoutAccount,h=c.active,b=c.accounts,x=Object(a.useState)(null),g=Object(u.a)(x,2),O=g[0],v=g[1];Object(a.useEffect)((function(){var e=function(){var e=Object(l.a)(s.a.mark((function e(){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(p.a)({authentication:new j.a(b[h]),url:t[t.env].featureServiceURL});case 3:(n=e.sent)&&n.fields&&v(!0),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),v(!1);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();h&&b[h]&&b[h].session&&e()}),[b,h,t]);var m=function(){i(n)};return h&&b[h]&&b[h].session&&null!==O?O?Object(ne.jsx)(Ye,{appConfig:t,account:b[h],userSession:new j.a(b[h].session),attemptLogout:function(){o(b[h])}}):(o(b[h]),Object(ne.jsx)(Ke,{attemptLogin:m})):Object(ne.jsx)(Ke,{attemptLogin:m})},Xe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,272)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))},$e=(n(265),n(20)),et=n.n($e),tt=n(177),nt=$e.CalciteTheme;nt.palette.Brand_Blue_200="#0a3f35",nt.palette.blue="#0a3f35",nt.palette.lightBlue="#6C8B85",nt.palette.darkBlue="#6C8B85",i.a.render(Object(ne.jsx)(r.a.StrictMode,{children:Object(ne.jsx)(et.a,{children:Object(ne.jsx)(Qe,{config:tt})})}),document.getElementById("root")),Xe()}},[[266,1,2]]]);
//# sourceMappingURL=main.373ade34.chunk.js.map